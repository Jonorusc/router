var O=Object.defineProperty;var e=(t,o)=>O(t,"name",{value:o,configurable:!0});var i=e(t=>t=="/"?t:t.replace(/\/index\.html$/,"").replace(/\/$/,""),"cleanPathnameOptionalEnding");var w=e(t=>{if(!t.trim().length)return!1;let o=new URL(t.trim(),location.origin),a=i(location.pathname)===i(o.pathname);return o.search?a&&o.search===location.search:a},"isOnPage");function C(t){if(t&&typeof t=="string")try{t=t==="undefined"?void 0:JSON.parse(t.replace(/['`]/g,'"'))}catch{}return t}e(C,"jsonParse");var y=e(()=>{let t=new URLSearchParams(window.location.search),o={};for(let a of t.keys()){let g=t.get(a);o[a]=g?C(g):null}return o},"getSearchQuery");var x=new Set,S=e(()=>{x.forEach(t=>{t(i(location.pathname),y(),R())})},"broadcast");window.addEventListener("popstate",()=>{S()});var f=e(t=>(x.add(t),t(i(location.pathname),y(),R()),()=>{x.delete(t)}),"onPageChange"),m=e((t,o={},a=document.title)=>{window.history.pushState(o,a,t),a!==document.title&&(document.title=a),S()},"goToPage"),b=e((t,o={},a=document.title)=>{window.history.replaceState(o,a,t),a!==document.title&&(document.title=a),S()},"replacePage"),T=e(()=>{window.history.back()},"previousPage"),E=e(()=>{window.history.forward()},"nextPage"),R=e(()=>window.history.state,"getPageData");var L=e(t=>{let o=t.parentNode;for(;o&&(o instanceof ShadowRoot&&(o=o.host),!/PAGE-ROUTE/.test(o.nodeName));)o=o.parentNode;return o??null},"getAncestorPageRoute");var v=e(({html:t,WebComponent:o})=>{class a extends o{static observedAttributes=["path","search","default","keep-current-search","title","data"];initialState={part:"anchor"};path="";search="";default=!1;keepCurrentSearch=!1;title="";data={};#t=null;fullPath=()=>{let c=new URLSearchParams(this.props.search()),r=this.props.path();if(!this.hasAttribute("path"))r=this.#t?.fullPath??"/";else if(r.startsWith("$")){let h=this.#t?.fullPath??"/";r=i(r.replace(/^\$/,h))}let s=new URL(r,location.origin);return this.props.keepCurrentSearch()&&new URLSearchParams(location.search).forEach((P,k)=>{s.searchParams.set(k,P)}),c.forEach((h,P)=>{s.searchParams.set(P,h)}),s.pathname+s.search};handleClick=c=>{c.preventDefault(),c.stopPropagation(),m(this.fullPath(),this.props.data(),this.props.title())};toggleClass=c=>{c?this.classList.add("active"):this.removeAttribute("class")};onMount(){return this.#t=L(this),f((c,r)=>{let s=w(this.fullPath()),h=s?"anchor active":"anchor";this.state.part()!==h&&(this.toggleClass(s),this.setState({part:h}),this.dispatch("active",{value:s})),this.props.default()&&this.props.search()&&!s&&w(this.props.path()||"/"+location.search)&&Array.from(new URLSearchParams(this.props.search())).some(([P])=>!r.hasOwnProperty(P))&&(this.setState({part:"anchor active"}),this.toggleClass(!0))})}render(){return t`
                <a
                    part="${this.state.part}"
                    href="${this.fullPath}"
                    onclick="${this.handleClick}"
                >
                    <slot></slot>
                </a>
            `}}e(a,"PageLink"),customElements.define("page-link",a)},"default");var A=e((t,o=!0)=>{t=i(t);let a=[],g=t.replace(/:([^/]+)/g,(c,r)=>(a.push(r),"([^/]+)"));return{pattern:new RegExp(`^${g}${o?"$":"*"}`),params:a}},"pathStringToPattern");var F=e((t,{pattern:o,params:a})=>{t=i(t);let g=t.match(o);if(g){let[,...c]=g;return a.reduce((r,s,h)=>({...r,[s]:c[h]??null}),{})}return null},"getPathMatchParams");var M=e(({html:t,is:o,WebComponent:a,when:g,HtmlTemplate:c})=>{let r=new Set([]);r.add("/");class s extends a{static observedAttributes=["path","src","title","exact"];initialState={status:0};path="";src="";title="";exact=!0;#t=String(Math.floor(Math.random()*1e3));#e={};#o=null;get fullPath(){return i((this.#o?.fullPath??"")+this.props.path())}_loadContent=async(p,u,d)=>{this.setState({status:1});let n=this.#e[p];if(!n)try{if(p.endsWith(".js"))({default:n}=await(p.startsWith("file:")?import(p.replace(/^file:/,"")):import(new URL(p,location.origin).href)));else{let l=await fetch(p);if(l.status===200)n=await l.text();else throw new Error(`Loading "${this.props.src()}" content failed with status code ${l.status}`)}this.#e[p]=n}catch(l){return this.setState({status:3}),console.error(l)}if(this.mounted)try{let l=n;typeof n=="function"&&(n=await n(R(),u,d)),typeof l=="object"&&n instanceof c||typeof n?.render=="function"?n.parentNode!==this&&(typeof l=="object"&&l instanceof c&&l!==n&&l.unmount(),this.innerHTML="",n.render(this)):n instanceof Node?(this.innerHTML="",this.appendChild(n)):this.innerHTML=String(n),this.setState({status:2})}catch(l){return this.setState({status:3}),console.error(l)}};_handlePageChange=(p,u)=>{let d=F(p,A(this.fullPath,this.props.exact()));d!==null?(this.hasAttribute("src")&&this.state.status()!==1&&this.state.status()!==2?this._loadContent(this.props.src(),d,u):this.state.status()!==2&&this.setState({status:2}),document.title=this.props.title()):this.state.status()!==0&&this.setState({status:0})};onMount(){this.#o=L(this);let p=new URL(this.fullPath,location.origin);return r.add(p.pathname),f(this._handlePageChange)}render(){return t`
                <slot
                    name="${()=>this.state.status()===2?"":this.#t}"
                ></slot>
                ${g(o(this.state.status,1),t`<slot name="loading"><p>Loading...</p></slot>`)}
                ${g(o(this.state.status,3),t` <slot name="fallback"
                        ><p>Failed to load content</p></slot
                    >`)}
            `}}e(s,"PageRoute");class h extends s{static observedAttributes=["key","value","src","default"];key="";value="";default=!1;get fullPath(){return""}_handlePageChange=(p,u)=>{let d=this.props.key();u[d]===void 0&&this.props.default()||u[d]===this.props.value()?this.props.src()&&this.state.status()!==1&&this.state.status()!==2?this._loadContent(this.props.src(),{},u):this.setState({status:2}):this.state.status()!==0&&this.setState({status:0})};onMount(){return f(this._handlePageChange)}}e(h,"PageRouteQuery");class P extends a{static observedAttributes=["to","type"];to="";type="unknown";onMount(){let p=L(this);return f(u=>{let d=i(p?.fullPath??"/");u.startsWith(d)&&(this.props.type()==="always"?u===d&&m(this.props.to()):r.has(u)||m(this.props.to()))})}}e(P,"PageRedirect"),customElements.define("page-route",s),customElements.define("page-route-query",h),customElements.define("page-redirect",P)},"default");if(!window.BFS?.MARKUP||!window.BFS.WebComponent)throw new Error('BFS.MARKUP and BFS.WebComponent are required in order for BFS.ROUTER to work. Please add the following script to the HTML head tag "<script src="https://unpkg.com/@beforesemicolon/web-component/dist/client.js"><\/script>"');if(window.BFS){let t={...window.BFS??{},...window.BFS?.MARKUP};M(t),v(t),window.BFS={...window.BFS||{},ROUTER:{goToPage:m,replacePage:b,previousPage:T,nextPage:E,onPageChange:f,isOnPage:w,getSearchQuery:y,getPageData:R}}}
//# sourceMappingURL=client.js.map
